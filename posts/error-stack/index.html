<!doctype html>

<html lang="en-us">

<head>
  <title>Gary talks tech</title>
  <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="description" content="The HTML5 Herald" />
<meta name="author" content="" /><meta property="og:title" content="Tracking errors in Golang" />
<meta property="og:description" content="Problem In Golang it&rsquo;s difficult to pinpoint the source of an error. Langauges like Java have a stack trace to tell you where the error is coming from. This feature is not there in Golang by default.
In this article, we will discuss how to use the fmt, and the github.com/pkg/errors libraries to give us better error reporting.
Consider this example:
package main import ( &#34;errors&#34; &#34;fmt&#34; ) func main() { result, err := funcA() if err !" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://gary-techs.github.io/posts/error-stack/" />
<meta property="article:published_time" content="2020-03-31T16:53:14+04:00" />
<meta property="article:modified_time" content="2020-03-31T16:53:14+04:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Tracking errors in Golang"/>
<meta name="twitter:description" content="Problem In Golang it&rsquo;s difficult to pinpoint the source of an error. Langauges like Java have a stack trace to tell you where the error is coming from. This feature is not there in Golang by default.
In this article, we will discuss how to use the fmt, and the github.com/pkg/errors libraries to give us better error reporting.
Consider this example:
package main import ( &#34;errors&#34; &#34;fmt&#34; ) func main() { result, err := funcA() if err !"/>

<meta name="generator" content="Hugo 0.74.3" />
    

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css" integrity="sha256-l85OmPOjvil/SOvVt3HnSSjzF1TUMyT9eV0c2BzEGzU=" crossorigin="anonymous" />
  <link rel="stylesheet" href="https://gary-techs.github.io/fontawesome/css/all.min.css" />
  
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Slab|Ruda" />
  
  
  <link rel="stylesheet" type="text/css" href="/css/styles.css" /></head>

<body>
  <div id="container">
    <header>
      <h1>
                <a href="/">Gary talks tech</a>
            </h1>

      <ul id="social-media">
      </ul>
      
    </header>

    
<nav>
    <ul>
        
        <li>
            <a class="" href="/about/">
                <i class="fa-li fa  fa-lg"></i><span>About Gary</span>
            </a>
        </li>
        
    </ul>
</nav>


    <main>




<article>

    <h1>Tracking errors in Golang</h1>

    
      <aside>
    <ul>
        <li>
            <time class="post-date" datetime="2020-03-31T16:53:14&#43;04:00">Mar 31, 2020</time>
        </li>
        

        

        <li>2 minutes read</li>
    </ul>
</aside>

    

    
<div class="featured_image">
    <a href="https://gary-techs.github.io/posts/error-stack/" title="Tracking errors in Golang">
        <img src="">
    </a>
</div>



    <h1 id="problem">Problem</h1>
<p>In Golang it&rsquo;s difficult to pinpoint the source of an error. Langauges like Java have a stack trace to tell you where the error is coming from. This feature is not there  in Golang by default.</p>
<p>In this article, we will discuss how to use the fmt, and the github.com/pkg/errors libraries to give us better error reporting.</p>
<p>Consider this example:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-golang" data-lang="golang"><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>

<span style="color:#f92672">import</span> (
	<span style="color:#e6db74">&#34;errors&#34;</span>
	<span style="color:#e6db74">&#34;fmt&#34;</span>
)

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
	<span style="color:#a6e22e">result</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">funcA</span>()
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;Error: &#34;</span>, <span style="color:#a6e22e">err</span>)
		<span style="color:#66d9ef">return</span>
	}
	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;Result: &#34;</span>, <span style="color:#a6e22e">result</span>)
}

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">funcA</span>() (<span style="color:#66d9ef">int</span>, <span style="color:#66d9ef">error</span>) {
	<span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">funcB</span>()
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>, <span style="color:#a6e22e">err</span>
	}
	<span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span>, <span style="color:#66d9ef">nil</span>
}

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">funcB</span>() <span style="color:#66d9ef">error</span> {
	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">funcC</span>()
}
<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">someFunc</span>() {
}

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">funcC</span>() <span style="color:#66d9ef">error</span> {
    <span style="color:#a6e22e">someFunc</span>()
	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">errors</span>.<span style="color:#a6e22e">New</span>(<span style="color:#e6db74">&#34;Failure&#34;</span>)
}
</code></pre></div><p>It gives us the output</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">Error:  Failure
</code></pre></div><p>Now, this does not really tell us much. What we really want to know is the cause of the error (which, in this case is the funcC function), and where the error came from (which would be the stack trace leading up to funcC)</p>
<h1 id="use-the-standard-library">Use the standard library</h1>
<p>We can use the fmt.Errorf function to wrap other errors and effectively generate a trace:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-golang" data-lang="golang">
<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">funcA</span>() (<span style="color:#66d9ef">int</span>, <span style="color:#66d9ef">error</span>) {
	<span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">funcB</span>()
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>, <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Errorf</span>(<span style="color:#e6db74">&#34;funcA error in calling funcB %v&#34;</span>, <span style="color:#a6e22e">err</span>)
	}
	<span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span>, <span style="color:#66d9ef">nil</span>
}
<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">someFunc</span>() {

}
<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">funcB</span>() <span style="color:#66d9ef">error</span> {
	<span style="color:#a6e22e">someFunc</span>()
	<span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">funcC</span>()
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Errorf</span>(<span style="color:#e6db74">&#34;funcB error in calling funcC %v&#34;</span>, <span style="color:#a6e22e">err</span>)
	}
	<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">nil</span>
}
</code></pre></div><p>This is better since it gives</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">Error:  funcA error in calling funcB funcB error in calling funcC Failure
</code></pre></div><p>This time, the error is much more descriptive, and tells us the sequence of events that lead to the error. Wrapping errors in the format gives us a consistent way to find its cause.</p>


</article>


<section class="post-nav">
    <ul>
        
        <li>
            <a href="https://gary-techs.github.io/posts/higher-order/"><i class="fa fa-chevron-circle-left"></i> Higher Order Functions, Closures in Go</a>
        </li>
        
        
        <li>
            <a href="https://gary-techs.github.io/posts/private-class-data/">Private Class Data pattern <i class="fa fa-chevron-circle-right"></i> </a>
        </li>
        
    </ul>
</section>
  
    
    
  





</main>
    <footer>
        <h6> |
            Rendered by <a href="https://gohugo.io" title="Hugo">Hugo</a> |
            <a href="https://gary-techs.github.io/index.xml">Subscribe </a></h6>
    </footer>
</div>
<script src="/js/scripts.js"></script>

</body>

</html>

